# Research Planner Recipe
# Decides which research phases to execute based on query analysis
# Part of the Research Role Integration architecture

name: research_planner
role: research_planner
phase: planning

# Prompt fragments (loaded in order)
prompt_fragments:
  - "apps/prompts/research_planner/core.md"
  - "apps/prompts/research_planner/decision_logic.md"

# Input documents
input_docs:
  - path: "context.md"
    optional: false
    max_tokens: 1500
    path_type: "turn"
    description: "User query + preferences + task plan (ยง0 has original query)"

  - path: "research_state.md"
    optional: true
    max_tokens: 500
    path_type: "turn"
    description: "Current research state (prior intelligence, sources visited)"

# Output documents
output_docs:
  - "research_plan.md"

# Token budget
token_budget:
  total: 3500
  prompt: 700
  input_docs: 2000  # Increased to accommodate research_state.md
  output: 600
  buffer: 200

# Trimming strategy (if budget exceeded)
trimming_strategy:
  method: truncate_end
  target: 2800

# Output schema
output_schema: RESEARCH_PLAN

# Description
description: |
  Research Planner decides which phases to execute:
  - PHASE1_ONLY: Need general intelligence, no specific results needed
  - PHASE2_ONLY: Already have intelligence, need specific results
  - PHASE1_THEN_PHASE2: Full research - gather intelligence then find results

  Input: context.md with query and preferences
  Output: research_plan.md with decision and strategy
