# Phase 2.1: Context Gathering â€” Retrieval (Memory Graph)
# Aligns with architecture/main-system-patterns/phase2.1-context-gathering-retrieval.md

name: phase1_context_gatherer_retrieval
category: pipeline
phase: 2
role: MIND
temperature: 0.6

prompt_fragments:
  - "apps/prompts/pipeline/phase1_context_gatherer_retrieval.md"

token_budget:
  total: 5500
  prompt: 900      # System prompt + instructions
  input_docs: 3600 # Unified memory index + query analysis
  output: 700      # RetrievalPlan JSON
  buffer: 300

input_docs:
  - path: "query_analysis"
    path_type: "input"
    max_tokens: 600
    description: "Phase 1 narrative (resolved_query, user_purpose, reasoning) + hints"
  - path: "unified_memory_index"
    path_type: "input"
    max_tokens: 3000
    description: "Memory graph nodes across turns, preferences, facts, cache, visit records"

output_doc:
  path: "retrieval_plan.json"
  path_type: "turn"
  description: "RetrievalPlan JSON with selected nodes and coverage"

output_schema: RETRIEVAL_PLAN
