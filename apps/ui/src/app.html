<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="Pandora AI - Intelligent Research Assistant" />
  <meta name="theme-color" content="#007bff" />
  <link rel="icon" href="/icons/panda-hamster.svg" />
  <style>
    /* Inline critical styles for instant rendering */
    :root {
      --panda-bg: #101014;
      --panda-surface: #17171c;
      --panda-text: #ececf1;
    }
    * { box-sizing: border-box; margin: 0; padding: 0; }
    html, body {
      background: var(--panda-bg);
      color: var(--panda-text);
      font-family: 'Segoe UI', sans-serif;
      min-height: 100vh;
    }
    #app-loading {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 16px;
      z-index: 9999;
      background: var(--panda-bg);
    }
    #app-loading.hidden { display: none; }
    #app-loading .spinner {
      width: 40px;
      height: 40px;
      border: 3px solid #22222a;
      border-top-color: #445fe6;
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }
    @keyframes spin { to { transform: rotate(360deg); } }
  </style>
  %sveltekit.head%
</head>
<body data-sveltekit-preload-data="hover">
  <div id="app-loading">
    <div class="spinner"></div>
    <p>Loading Pandora AI...</p>
    <p id="debug-status" style="font-size:12px;color:#666;margin-top:20px;"></p>
  </div>
  <div style="display: contents">%sveltekit.body%</div>
  <script>
    var debugEl = document.getElementById('debug-status');
    function debug(msg) {
      if (debugEl) debugEl.textContent = msg;
      console.log('[Debug]', msg);
    }
    debug('Script loaded');

    // Catch and display any JavaScript errors
    window.onerror = function(msg, url, line, col, error) {
      var loader = document.getElementById('app-loading');
      if (loader) {
        loader.innerHTML = '<div style="color:#ff6b6b;padding:20px;text-align:left;max-width:600px;">' +
          '<h2 style="margin-bottom:12px;">JavaScript Error</h2>' +
          '<p style="font-family:monospace;background:#1a1a22;padding:12px;border-radius:6px;overflow:auto;">' +
          msg + '<br>at ' + url + ':' + line + ':' + col +
          '</p></div>';
      }
      console.error('App Error:', msg, url, line, col, error);
      return false;
    };

    // Also catch unhandled promise rejections
    window.onunhandledrejection = function(event) {
      debug('Promise rejected: ' + event.reason);
      console.error('Unhandled rejection:', event.reason);
    };
  </script>
</body>
</html>
